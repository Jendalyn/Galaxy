syntax = "proto3";
package validation;

service Validation {
    rpc GenerateSPVProof (GenerateSPVProofRequest) returns (GenerateSPVProofResponse);
    rpc VerifySPVProof (VerifySPVProofRequest) returns (VerifySPVProofResponse);
    rpc BatchGenerateSPVProof (BatchGenerateSPVProofRequest) returns (BatchGenerateSPVProofResponse);
    rpc StreamSPVProofs (stream StreamSPVProofsRequest) returns (stream StreamSPVProofsResponse);
    rpc GetMetrics (GetMetricsRequest) returns (GetMetricsResponse);
}

message GenerateSPVProofRequest {
    string txid = 1; // Transaction ID (hex)
}
message GenerateSPVProofResponse {
    bool success = 1;
    string merkle_path = 2; // Hex-encoded merkle path
    repeated string block_headers = 3; // Hex-encoded block headers
    string error = 4; // Error message if generation fails
}
message VerifySPVProofRequest {
    string txid = 1; // Transaction ID (hex)
    string merkle_path = 2; // Hex-encoded merkle path
    repeated string block_headers = 3; // Hex-encoded block headers
}
message VerifySPVProofResponse {
    bool is_valid = 1;
    string error = 2; // Error message if verification fails
}
message BatchGenerateSPVProofRequest {
    repeated string txids = 1; // List of transaction IDs (hex)
}
message BatchGenerateSPVProofResponse {
    repeated GenerateSPVProofResponse results = 1; // Results for each proof
}
message StreamSPVProofsRequest {
    string txid = 1; // Transaction ID (hex) to monitor
}
message StreamSPVProofsResponse {
    bool success = 1;
    string txid = 2; // Transaction ID (hex)
    string merkle_path = 3; // Hex-encoded merkle path
    repeated string block_headers = 4; // Hex-encoded block headers
    string error = 5; // Error message if generation fails
}
message GetMetricsRequest {}
message GetMetricsResponse {
    uint64 proof_requests = 1; // Total SPV proof requests
    double avg_latency_ms = 2; // Average proof generation latency
    uint64 cache_hits = 3; // Cache hit count
}
